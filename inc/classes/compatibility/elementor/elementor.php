<?php
/**
 * Astra Sites Elementor
 *
 * @package Astra Sites
 * @since 1.0.4
 */

if( ! class_exists( 'Astra_Sites_Comp_Elementor' ) ) :

	/**
	 * Astra_Sites_Comp_Elementor
	 *
	 * @since 1.0.4
	 */
	class Astra_Sites_Comp_Elementor {

		/**
		 * @var Astra_Elementor_Image_Importer_Process
		 */
		protected $process_all;

		/**
		 * Instance
		 *
		 * @access private
		 * @since 1.0.4
		 */
		private static $instance;

		/**
		 * Initiator
		 *
		 * @since 1.0.4
		 * @return object initialized object of class.
		 */
		public static function set_instance(){
			if ( ! isset( self::$instance ) ) {
				self::$instance = new self;
			}
			return self::$instance;
		}

		/**
		 * Constructor
		 *
		 * @since 1.0.4
		 */
		public function __construct() {

			require_once ABSPATH . 'wp-admin/includes/image.php';

			require_once ASTRA_SITES_DIR . 'inc/classes/compatibility/elementor/api-helper.php';
			require_once ASTRA_SITES_DIR . 'inc/classes/compatibility/elementor/background-processing/class-logger.php';
			require_once ASTRA_SITES_DIR . 'inc/classes/compatibility/elementor/background-processing/class-example-process.php';
			$this->process_all    = new Astra_Elementor_Image_Importer_Process();

			// $this->astra_sites_process_handler();


			// add_action( 'plugins_loaded', array( $this, 'plugins_loaded' ) );
			
			add_action( 'admin_head', array( $this, 'test' ) );
			// add_action( 'admin_head', 											array( $this, 'astra_sites_process_handler' ) );
			// add_action( 'astra_sites_import_complete', 							array( $this, 'set_image_import_on' ) );
			// add_action( 'astra_sites_elementor_image_import_complete', 			array( $this, 'set_image_import_off' ) );
			
			
			add_action( 'astra_sites_import_complete', array( $this, 'astra_sites_process_handler' ) );
		}

		function test() {

			// ob_start();
			// var_dump( 'ok' );
			// error_log( ob_get_clean() ) ;
			// wp_die();
			$data = get_post_meta( get_the_id(), '_elementor_data', true );

			// $data = '[{"id":"3vfx5aa","elType":"section","settings":{"stretch_section":"section-stretched","background_background":"classic","background_image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/home-banner.jpg","id":317},"shape_divider_bottom_flip":"yes","background_overlay_background":"classic","background_overlay_color_b":"#2bffcd","background_overlay_gradient_angle":{"unit":"deg","size":90},"background_overlay_opacity":{"unit":"px","size":0},"shape_divider_bottom_color":"#ffffff","shape_divider_bottom_height":{"unit":"px","size":100},"shape_divider_bottom_height_tablet":{"unit":"px","size":"65"},"shape_divider_bottom_negative":"yes","shape_divider_bottom_above_content":"yes","background_overlay_color":"#ffffff","background_repeat":"no-repeat","background_size":"cover","structure":"20","background_position":"center right","margin":{"unit":"px","top":"0","right":0,"bottom":"0","left":0,"isLinked":true},"margin_mobile":{"unit":"px","top":"0","right":0,"bottom":"0","left":0,"isLinked":true},"animation":"fadeIn","margin_tablet":{"unit":"px","top":"0","right":0,"bottom":"0","left":0,"isLinked":false},"padding":{"unit":"px","top":"250","right":"0","bottom":"250","left":"0","isLinked":false},"padding_tablet":{"unit":"px","top":"20","right":"0","bottom":"20","left":"0","isLinked":false},"padding_mobile":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[{"id":"h991bof","elType":"column","settings":{"_column_size":50,"_inline_size":"60.000","_inline_size_tablet":65,"padding_tablet":{"unit":"px","top":"20","right":"20","bottom":"20","left":"20","isLinked":true}},"elements":[{"id":"z8p9dzo","elType":"widget","settings":{"editor":"<p>FASTEST AND MOST LIGHTWEIGHT WP THEME<\/p>","align":"left","text_color":"#000000","typography_typography":"custom","typography_font_size":{"unit":"em","size":"1"},"typography_font_weight":"600","typography_line_height":{"unit":"em","size":"2"},"typography_letter_spacing":{"unit":"px","size":"4"},"_animation":"fadeInUp","align_tablet":"left","align_mobile":"center"},"elements":[],"widgetType":"text-editor"},{"id":"xpld4o6","elType":"widget","settings":{"title":"Stunning Business Website","size":"xxl","header_size":"h1","title_color":"#434343","typography_typography":"custom","typography_font_size":{"unit":"em","size":"4"},"typography_letter_spacing":{"unit":"px","size":"0"},"_animation":"fadeInUp","align":"left","align_tablet":"left","align_mobile":"center","typography_font_size_tablet":{"unit":"em","size":"3"},"typography_font_size_mobile":{"unit":"em","size":"4"},"typography_font_weight":"700","typography_font_family":"Rubik"},"elements":[],"widgetType":"heading"},{"id":"1d3k1wu","elType":"widget","settings":{"editor":"<p>Create your own website in Minutes. No coding skills required.<\/p>","align":"left","text_color":"#434343","typography_typography":"custom","typography_font_size":{"unit":"em","size":"1"},"typography_font_weight":"400","typography_line_height":{"unit":"em","size":"2"},"typography_letter_spacing":{"unit":"px","size":"0"},"_animation":"fadeInUp","align_tablet":"left","align_mobile":"center","typography_font_size_tablet":{"unit":"em","size":"1"},"typography_font_size_mobile":{"unit":"em","size":1.25},"_padding_mobile":{"unit":"px","top":"0","right":"30","bottom":"0","left":"30","isLinked":false}},"elements":[],"widgetType":"text-editor"},{"id":"5vfkhnn","elType":"widget","settings":{"space":{"unit":"px","size":"5"},"space_tablet":{"unit":"px","size":5}},"elements":[],"widgetType":"spacer"},{"id":"asta3d9","elType":"widget","settings":{"text":"MORE INFO","typography_typography":"custom","typography_font_size":{"unit":"em","size":"0.9"},"typography_font_family":"Montserrat","typography_font_weight":"700","typography_text_transform":"uppercase","typography_letter_spacing":{"unit":"px","size":"3"},"border_radius":{"unit":"px","top":"50","right":"50","bottom":"50","left":"50","isLinked":true},"button_type":"info","align":"left","button_text_color":"#434343","background_color":"rgba(64,100,215,0)","hover_color":"#ffffff","button_background_hover_color":"#4064d7","border_width":{"unit":"px","top":"2","right":"2","bottom":"2","left":"2","isLinked":true},"border_color":"#434343","link":{"is_external":"","url":"#About"},"_animation":"fadeInUp","align_tablet":"left","button_hover_border_color":"#4064d7","border_border":"solid","text_padding":{"unit":"px","top":"15","right":"30","bottom":"15","left":"30","isLinked":false},"align_mobile":"center","_margin_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"_padding_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"button"}],"isInner":false},{"id":"v0kzet2","elType":"column","settings":{"_column_size":50,"_inline_size":"40.000"},"elements":[{"id":"vb97hs0","elType":"widget","settings":{"space":{"unit":"px","size":"175"},"space_tablet":{"unit":"px","size":"20"}},"elements":[],"widgetType":"spacer"}],"isInner":false}],"isInner":false},{"id":"1u4upoi","elType":"section","settings":{"stretch_section":"section-stretched","background_background":"classic","padding_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[{"id":"ge1h3f7","elType":"column","settings":{"_column_size":100,"_inline_size":null},"elements":[{"id":"tqqiy8o","elType":"widget","settings":{"anchor":"About"},"elements":[],"widgetType":"menu-anchor"},{"id":"9fctebx","elType":"widget","settings":{"space":{"unit":"px","size":"100"}},"elements":[],"widgetType":"spacer"},{"id":"4uc3aor","elType":"widget","settings":{"title":"How we can help you?","header_size":"h3","align":"center","title_color":"#000000","typography_typography":"custom","typography_font_size":{"unit":"em","size":"3"},"typography_font_size_mobile":{"unit":"em","size":"2.2"},"typography_font_weight":"700"},"elements":[],"widgetType":"heading"},{"id":"rrofhpi","elType":"widget","settings":{"space":{"unit":"px","size":"10"}},"elements":[],"widgetType":"spacer"},{"id":"h2cfn4h","elType":"widget","settings":{"color":"#4064d7","width":{"unit":"%","size":"10"},"align":"center","gap":{"unit":"px","size":2},"_margin":{"unit":"px","top":"-25","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"divider"},{"id":"pprvf0c","elType":"widget","settings":{"color":"#4064d7","width":{"unit":"%","size":"10"},"align":"center","gap":{"unit":"px","size":2},"_margin":{"unit":"px","top":"-25","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"divider"},{"id":"jwlw0sy","elType":"widget","settings":{"color":"#4064d7","width":{"unit":"%","size":"10"},"align":"center","gap":{"unit":"px","size":2},"_margin":{"unit":"px","top":"-25","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"divider"},{"id":"43z9h6r","elType":"widget","settings":{"editor":"<p>Sed Fringilla Mauris Sit Amet Nibh. Donec Sodales Sagittis Magna. Sed Consequat, Leo Eget Bibendum Sodales, Augue Velit Cursus Nunc, Quis Gravida Magna Mi A Libero.<\/p>","align":"center","text_color":"#545454","typography_typography":"custom","_padding":{"unit":"px","top":"0","right":"200","bottom":"0","left":"200","isLinked":false},"_padding_tablet":{"unit":"px","top":"0","right":"50","bottom":"0","left":"50","isLinked":false},"_padding_mobile":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"_margin":{"unit":"px","top":"0","right":"0","bottom":"74","left":"0","isLinked":false}},"elements":[],"widgetType":"text-editor"},{"id":"mqelytj","elType":"section","settings":{"structure":"30","margin":{"unit":"px","top":"0","right":0,"bottom":"0","left":0,"isLinked":false}},"elements":[{"id":"pel0pkb","elType":"column","settings":{"_column_size":33,"_inline_size":null,"background_background":"classic","background_color":"#ffffff","margin":{"unit":"px","top":"10","right":"10","bottom":"10","left":"10","isLinked":true}},"elements":[{"id":"w5dkvx5","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/editing.png","id":177},"title_text":"Design","description_text":"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse et justo. Praesent mattis commodo augue.","image_space":{"unit":"px","size":"17"},"image_size":{"unit":"%","size":"16"},"title_color":"#000000","title_typography_typography":"custom","title_typography_font_size":{"unit":"px","size":"22"},"description_color":"#545454","description_typography_typography":"custom","description_typography_font_size":{"unit":"em","size":"1"},"description_typography_font_weight":"400","description_typography_line_height":{"unit":"em","size":"2"},"description_typography_letter_spacing":{"unit":"px","size":"0"},"title_typography_line_height":{"unit":"px","size":"28"},"position":"left"},"elements":[],"widgetType":"image-box"}],"isInner":true},{"id":"o8wgvqy","elType":"column","settings":{"_column_size":33,"_inline_size":null,"background_background":"classic","background_color":"#ffffff","margin":{"unit":"px","top":"10","right":"10","bottom":"10","left":"10","isLinked":true}},"elements":[{"id":"8la837o","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/coding-1-1.png","id":259},"title_text":"Development","description_text":"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse et justo. Praesent mattis commodo augue.","image_space":{"unit":"px","size":"17"},"image_size":{"unit":"%","size":"16"},"title_color":"#000000","title_typography_typography":"custom","title_typography_font_size":{"unit":"px","size":"22"},"description_color":"#545454","description_typography_typography":"custom","description_typography_font_size":{"unit":"em","size":"1"},"description_typography_font_weight":"400","description_typography_line_height":{"unit":"em","size":"2"},"description_typography_letter_spacing":{"unit":"px","size":"0"},"title_typography_line_height":{"unit":"px","size":"28"},"position":"left"},"elements":[],"widgetType":"image-box"}],"isInner":true},{"id":"oaqyuwu","elType":"column","settings":{"_column_size":33,"_inline_size":null,"margin":{"unit":"px","top":"10","right":"10","bottom":"10","left":"10","isLinked":true}},"elements":[{"id":"ji98gu1","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/marketing-1.png","id":346},"title_text":"Marketing","description_text":"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse et justo. Praesent mattis commodo augue.","image_space":{"unit":"px","size":"17"},"image_size":{"unit":"%","size":"16"},"title_color":"#000000","title_typography_typography":"custom","title_typography_font_size":{"unit":"px","size":"22"},"description_color":"#545454","description_typography_typography":"custom","description_typography_font_size":{"unit":"em","size":"1"},"description_typography_font_weight":"400","description_typography_line_height":{"unit":"em","size":"2"},"description_typography_letter_spacing":{"unit":"px","size":"0"},"title_typography_line_height":{"unit":"px","size":"28"},"position":"left"},"elements":[],"widgetType":"image-box"}],"isInner":true}],"isInner":true},{"id":"awtba9l","elType":"section","settings":{"structure":"30","margin":{"unit":"px","top":"0","right":0,"bottom":"0","left":0,"isLinked":false}},"elements":[{"id":"g1sdwvp","elType":"column","settings":{"_column_size":33,"_inline_size":null,"background_background":"classic","background_color":"#ffffff","margin":{"unit":"px","top":"10","right":"10","bottom":"10","left":"10","isLinked":true}},"elements":[{"id":"lh3mrqk","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/share.png","id":261},"title_text":"Social media","description_text":"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse et justo. Praesent mattis commodo augue.","image_space":{"unit":"px","size":"17"},"image_size":{"unit":"%","size":"16"},"title_color":"#000000","title_typography_typography":"custom","title_typography_font_size":{"unit":"px","size":"22"},"description_color":"#545454","description_typography_typography":"custom","description_typography_font_size":{"unit":"em","size":"1"},"description_typography_font_weight":"400","description_typography_line_height":{"unit":"em","size":"2"},"description_typography_letter_spacing":{"unit":"px","size":"0"},"title_typography_line_height":{"unit":"px","size":"28"},"position":"left"},"elements":[],"widgetType":"image-box"}],"isInner":true},{"id":"4m5bvuo","elType":"column","settings":{"_column_size":33,"_inline_size":null,"background_background":"classic","background_color":"#ffffff","margin":{"unit":"px","top":"10","right":"10","bottom":"10","left":"10","isLinked":true}},"elements":[{"id":"mqzzl25","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/cart.png","id":176},"title_text":"eCommerce","description_text":"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse et justo. Praesent mattis commodo augue.","image_space":{"unit":"px","size":"17"},"image_size":{"unit":"%","size":"16"},"title_color":"#000000","title_typography_typography":"custom","title_typography_font_size":{"unit":"px","size":"22"},"description_color":"#545454","description_typography_typography":"custom","description_typography_font_size":{"unit":"em","size":"1"},"description_typography_font_weight":"400","description_typography_line_height":{"unit":"em","size":"2"},"description_typography_letter_spacing":{"unit":"px","size":"0"},"title_typography_line_height":{"unit":"px","size":"28"},"position":"left"},"elements":[],"widgetType":"image-box"}],"isInner":true},{"id":"sy0zhtq","elType":"column","settings":{"_column_size":33,"_inline_size":null,"margin":{"unit":"px","top":"10","right":"10","bottom":"10","left":"10","isLinked":true}},"elements":[{"id":"iuxa07q","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/support.png","id":179},"title_text":"Help & Support","description_text":"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse et justo. Praesent mattis commodo augue.","image_space":{"unit":"px","size":"17"},"image_size":{"unit":"%","size":"16"},"title_color":"#000000","title_typography_typography":"custom","title_typography_font_size":{"unit":"px","size":"22"},"description_color":"#545454","description_typography_typography":"custom","description_typography_font_size":{"unit":"em","size":"1"},"description_typography_font_weight":"400","description_typography_line_height":{"unit":"em","size":"2"},"description_typography_letter_spacing":{"unit":"px","size":"0"},"title_typography_line_height":{"unit":"px","size":"28"},"position":"left"},"elements":[],"widgetType":"image-box"}],"isInner":true}],"isInner":true},{"id":"5tdf194","elType":"widget","settings":{"space":{"unit":"px","size":"100"}},"elements":[],"widgetType":"spacer"}],"isInner":false}],"isInner":false},{"id":"3gfgm7m","elType":"section","settings":{"stretch_section":"section-stretched","background_background":"classic","layout":"full_width","gap":"no","background_overlay_background":"classic","background_overlay_opacity":{"unit":"px","size":0.87}},"elements":[{"id":"6xd7dpl","elType":"column","settings":{"_column_size":100,"_inline_size":null},"elements":[{"id":"0qa8fxh","elType":"widget","settings":{"title":"Portfolio","header_size":"h3","align":"center","title_color":"#000000","typography_typography":"custom","typography_font_size":{"unit":"em","size":"3"},"typography_font_size_mobile":{"unit":"em","size":"2.2"},"typography_font_weight":"700","typography_font_size_tablet":{"unit":"em","size":"4"}},"elements":[],"widgetType":"heading"},{"id":"0kyzcff","elType":"widget","settings":{"color":"#4064d7","width":{"unit":"%","size":"8"},"align":"center","gap":{"unit":"px","size":2},"_margin":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"divider"},{"id":"1z8n5hy","elType":"widget","settings":{"space":{"unit":"px","size":"10"},"space_tablet":{"unit":"px","size":"20"},"space_mobile":{"unit":"px","size":"20"}},"elements":[],"widgetType":"spacer"},{"id":"qmqd0xv","elType":"section","settings":{"layout":"full_width","gap":"no","content_position":"bottom","structure":"40","margin":{"unit":"px","top":"0","right":0,"bottom":"0","left":0,"isLinked":false}},"elements":[{"id":"t8scu0x","elType":"column","settings":{"_column_size":25,"_inline_size":null,"background_background":"classic","background_image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/07\/proj3.jpg","id":598},"background_position":"center center","background_repeat":"no-repeat","background_size":"cover","background_overlay_background":"classic","background_overlay_color":"#000000","background_overlay_opacity":{"unit":"px","size":0.4},"background_overlay_hover_background":"classic","background_overlay_hover_color":"#000000","padding":{"unit":"px","top":"20","right":"20","bottom":"20","left":"20","isLinked":true},"_inline_size_tablet":50},"elements":[{"id":"opotqr7","elType":"widget","settings":{"space":{"unit":"px","size":300}},"elements":[],"widgetType":"spacer"},{"id":"ijcsyd8","elType":"widget","settings":{"text":"VIEW PRODUCTS","icon":"fa fa-arrow-right","icon_align":"right","icon_indent":{"unit":"px","size":10},"typography_typography":"custom","typography_font_size":{"unit":"em","size":1},"typography_font_weight":"700","typography_letter_spacing":{"unit":"px","size":2},"button_text_color":"#e0e0e0","background_color":"rgba(0,0,0,0)","hover_color":"#ffffff","text_padding":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true}},"elements":[],"widgetType":"button"}],"isInner":true},{"id":"065xjrj","elType":"column","settings":{"_column_size":25,"_inline_size":null,"background_background":"classic","background_image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/07\/proj7.jpg","id":599},"background_position":"center center","background_repeat":"no-repeat","background_size":"cover","background_overlay_background":"classic","background_overlay_color":"#000000","background_overlay_opacity":{"unit":"px","size":0.4},"background_overlay_hover_background":"classic","background_overlay_hover_color":"#000000","padding":{"unit":"px","top":"20","right":"20","bottom":"20","left":"20","isLinked":true},"_inline_size_tablet":50},"elements":[{"id":"dnssed0","elType":"widget","settings":{"space":{"unit":"px","size":300}},"elements":[],"widgetType":"spacer"},{"id":"a5huodu","elType":"widget","settings":{"text":"VIEW PRODUCTS","icon":"fa fa-arrow-right","icon_align":"right","icon_indent":{"unit":"px","size":10},"typography_typography":"custom","typography_font_size":{"unit":"em","size":1},"typography_font_weight":"700","typography_letter_spacing":{"unit":"px","size":2},"button_text_color":"#e0e0e0","background_color":"rgba(0,0,0,0)","hover_color":"#ffffff","text_padding":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true}},"elements":[],"widgetType":"button"}],"isInner":true},{"id":"4dmvrcn","elType":"column","settings":{"_column_size":25,"_inline_size":null,"background_background":"classic","background_image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/07\/proj6.jpg","id":600},"background_position":"center center","background_repeat":"no-repeat","background_size":"cover","background_overlay_background":"classic","background_overlay_color":"#000000","background_overlay_opacity":{"unit":"px","size":0.4},"background_overlay_hover_background":"classic","background_overlay_hover_color":"#000000","padding":{"unit":"px","top":"20","right":"20","bottom":"20","left":"20","isLinked":true},"_inline_size_tablet":50},"elements":[{"id":"zn1w0da","elType":"widget","settings":{"space":{"unit":"px","size":300}},"elements":[],"widgetType":"spacer"},{"id":"lu1xga6","elType":"widget","settings":{"text":"VIEW PRODUCTS","icon":"fa fa-arrow-right","icon_align":"right","icon_indent":{"unit":"px","size":10},"typography_typography":"custom","typography_font_size":{"unit":"em","size":1},"typography_font_weight":"700","typography_letter_spacing":{"unit":"px","size":2},"button_text_color":"#e0e0e0","background_color":"rgba(0,0,0,0)","hover_color":"#ffffff","text_padding":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true}},"elements":[],"widgetType":"button"}],"isInner":true},{"id":"jd11pkq","elType":"column","settings":{"_column_size":25,"_inline_size":null,"background_background":"classic","background_image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/07\/proj5-free-img","id":601},"background_position":"center center","background_repeat":"no-repeat","background_size":"cover","background_overlay_background":"classic","background_overlay_color":"#000000","background_overlay_opacity":{"unit":"px","size":0.4},"background_overlay_hover_background":"classic","background_overlay_hover_color":"#000000","padding":{"unit":"px","top":"20","right":"20","bottom":"20","left":"20","isLinked":true},"_inline_size_tablet":50},"elements":[{"id":"unhexzy","elType":"widget","settings":{"space":{"unit":"px","size":300}},"elements":[],"widgetType":"spacer"},{"id":"wdaanf3","elType":"widget","settings":{"text":"VIEW PRODUCTS","icon":"fa fa-arrow-right","icon_align":"right","icon_indent":{"unit":"px","size":10},"typography_typography":"custom","typography_font_size":{"unit":"em","size":1},"typography_font_weight":"700","typography_letter_spacing":{"unit":"px","size":2},"button_text_color":"#e0e0e0","background_color":"rgba(0,0,0,0)","hover_color":"#ffffff","text_padding":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true}},"elements":[],"widgetType":"button"}],"isInner":true}],"isInner":true}],"isInner":false}],"isInner":false},{"id":"ow7fkx4","elType":"section","settings":{"stretch_section":"section-stretched","background_background":"classic","background_color":"#ffffff"},"elements":[{"id":"2h7hgqr","elType":"column","settings":{"_column_size":100,"_inline_size":null},"elements":[{"id":"6lofdsl","elType":"widget","settings":{"space":{"unit":"px","size":"100"},"space_tablet":{"unit":"px","size":"75"},"_margin":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"spacer"},{"id":"t4kigla","elType":"widget","settings":{"title":"Who we have worked with","header_size":"h3","align":"center","title_color":"#000000","typography_typography":"custom","typography_font_size":{"unit":"em","size":"3"},"typography_font_size_mobile":{"unit":"em","size":"2.2"},"typography_font_weight":"700","typography_font_size_tablet":{"unit":"em","size":"4"}},"elements":[],"widgetType":"heading"},{"id":"t6e8r0x","elType":"widget","settings":{"color":"#4064d7","width":{"unit":"%","size":"10"},"align":"center","gap":{"unit":"px","size":2},"_margin":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"divider"},{"id":"c57nv4b","elType":"widget","settings":{"space":{"unit":"px","size":"50"}},"elements":[],"widgetType":"spacer"},{"id":"fiqnqkz","elType":"widget","settings":{"carousel":[{"id":339,"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/client1.png"},{"id":340,"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/client2.png"},{"id":341,"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/client3.png"},{"id":342,"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/client4.png"},{"id":343,"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/client5.png"},{"id":344,"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/client6.png"}],"slides_to_show":"5","slides_to_scroll":"1","arrows_color":"#8c8c8c","thumbnail_size":"custom","thumbnail_custom_dimension":{"width":"150","height":""},"image_spacing_custom":{"unit":"px","size":0},"dots_color":"#4064d7"},"elements":[],"widgetType":"image-carousel"},{"id":"bv6t01t","elType":"widget","settings":{"space":{"unit":"px","size":"100"},"space_tablet":{"unit":"px","size":"75"}},"elements":[],"widgetType":"spacer"}],"isInner":false}],"isInner":false},{"id":"ps94fk6","elType":"section","settings":{"stretch_section":"section-stretched","background_background":"classic","background_color":"#ffffff","padding_mobile":{"unit":"px","top":"5","right":"5","bottom":"5","left":"5","isLinked":true}},"elements":[{"id":"dzxf2qo","elType":"column","settings":{"_column_size":100,"_inline_size":null,"border_width":{"unit":"px","top":"5","right":"5","bottom":"5","left":"5","isLinked":true},"border_color":"#4064d7"},"elements":[{"id":"nyge1y4","elType":"section","settings":{"content_position":"middle","border_border":"solid","border_width":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"margin":{"unit":"px","top":"","right":0,"bottom":"","left":0,"isLinked":true},"padding_mobile":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true}},"elements":[{"id":"fml2rst","elType":"column","settings":{"_column_size":100,"_inline_size":null,"border_border":"solid","border_width":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"padding":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"padding_mobile":{"unit":"px","top":"30","right":"5","bottom":"30","left":"5","isLinked":false}},"elements":[{"id":"yvqfpyi","elType":"widget","settings":{"title":"What clients say","align":"center","title_color":"#000000","typography_typography":"custom","typography_font_size":{"unit":"em","size":"3"},"typography_font_size_mobile":{"unit":"em","size":"2.2"},"typography_font_weight":"700","_margin":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false},"_margin_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"_margin_mobile":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"_padding_mobile":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"_background_background":"classic","_background_color":"#ffffff"},"elements":[],"widgetType":"heading"},{"id":"usqd0kh","elType":"widget","settings":{"color":"#4064d7","width":{"unit":"%","size":"10"},"align":"center","gap":{"unit":"px","size":2},"_margin":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"divider"},{"id":"cv0yb03","elType":"widget","settings":{"space":{"unit":"px","size":"5"},"space_tablet":{"unit":"px","size":"5"},"space_mobile":{"unit":"px","size":"5"}},"elements":[],"widgetType":"spacer"},{"id":"hc1ct6s","elType":"widget","settings":{"testimonial_content":"Nam at congue diam. Etiam erat lectus, finibus eget commodo quis, tincidunt eget leo. Nullam quis vulputate orci, ac accumsan quam. Morbi fringilla congue libero, ac malesuada vulputate pharetra.","testimonial_image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/student-1.jpg","id":93},"testimonial_name":"John Doe","testimonial_job":"Designer","content_typography_typography":"custom","content_typography_font_size":{"unit":"em","size":"1.1"},"content_typography_font_weight":"400","content_typography_line_height":{"unit":"em","size":"2"},"name_text_color":"#000000","name_typography_typography":"custom","name_typography_font_size":{"unit":"em","size":"2"},"name_typography_font_weight":"600","job_text_color":"#545454","job_typography_typography":"custom","job_typography_font_weight":"500","_padding_tablet":{"unit":"px","top":"20","right":"20","bottom":"20","left":"20","isLinked":true},"_padding_mobile":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"content_typography_font_size_mobile":{"unit":"em","size":"1"},"name_typography_font_size_mobile":{"unit":"em","size":"1.5"},"job_typography_font_size":{"unit":"em","size":"0.9"},"job_typography_font_size_mobile":{"unit":"em","size":"0.8"},"job_typography_text_transform":"uppercase","job_typography_letter_spacing":{"unit":"px","size":"3"},"testimonial_image_position":"top","_padding":{"unit":"px","top":"0","right":"140","bottom":"0","left":"140","isLinked":false}},"elements":[],"widgetType":"testimonial"},{"id":"frnvx88","elType":"widget","settings":{"space":{"unit":"px","size":"100"},"space_tablet":{"unit":"px","size":"75"}},"elements":[],"widgetType":"spacer"}],"isInner":true}],"isInner":true}],"isInner":false}],"isInner":false},{"id":"6v5ll6o","elType":"section","settings":{"stretch_section":"section-stretched","background_background":"classic","background_color":"#f4f4f7","animation":"fadeIn","layout":"full_width","padding_mobile":{"unit":"px","top":"5","right":"5","bottom":"5","left":"5","isLinked":true}},"elements":[{"id":"3xb1dok","elType":"column","settings":{"_column_size":100,"_inline_size":null,"padding_mobile":{"unit":"px","top":"10","right":"10","bottom":"10","left":"10","isLinked":true}},"elements":[{"id":"dz4k2co","elType":"widget","settings":{"space":{"unit":"px","size":"75"},"space_tablet":{"unit":"px","size":"30"},"space_mobile":{"unit":"px","size":"30"}},"elements":[],"widgetType":"spacer"},{"id":"lp5s1jt","elType":"widget","settings":{"title":"Meet the team","header_size":"h3","align":"center","title_color":"#000000","typography_typography":"custom","typography_font_size":{"unit":"em","size":"3"},"typography_font_size_mobile":{"unit":"em","size":"2.2"},"typography_font_weight":"700","typography_font_size_tablet":{"unit":"em","size":"4"}},"elements":[],"widgetType":"heading"},{"id":"ji54d96","elType":"widget","settings":{"color":"#4064d7","width":{"unit":"%","size":"10"},"align":"center","gap":{"unit":"px","size":2},"_margin":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"divider"},{"id":"csf2atq","elType":"section","settings":{"structure":"30","margin":{"unit":"px","top":"","right":0,"bottom":"","left":0,"isLinked":true}},"elements":[{"id":"v0uf612","elType":"column","settings":{"_column_size":33,"_inline_size":null,"animation":"fadeIn"},"elements":[{"id":"4yand6g","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/teammate3.jpg","id":281},"align":"left","align_tablet":"left","align_mobile":"left"},"elements":[],"widgetType":"image"},{"id":"510hihb","elType":"widget","settings":{"title":"JOANNE WILLIAMS","header_size":"h4","title_color":"#000000","typography_typography":"custom","typography_text_transform":"uppercase","typography_line_height":{"unit":"px","size":""},"typography_font_weight":"900"},"elements":[],"widgetType":"heading"},{"id":"4ejws25","elType":"widget","settings":{"editor":"<p>MANAGER<\/p>","align":"left","typography_typography":"custom","typography_font_weight":"400","typography_line_height":{"unit":"px","size":""},"_margin":{"unit":"px","top":"-15","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"text-editor"},{"id":"6akkpft","elType":"widget","settings":{"social_icon_list":[{"social":"fa fa-facebook","_id":"z6ub5rs","link":{"is_external":"true","url":""}},{"social":"fa fa-twitter","_id":"iq06iau","link":{"is_external":"true","url":""}},{"social":"fa fa-google-plus","_id":"b0a3i9i","link":{"is_external":"true","url":""}}],"align":"left","icon_color":"custom","icon_primary_color":"#545454","icon_size":{"unit":"px","size":"12"}},"elements":[],"widgetType":"social-icons"}],"isInner":true},{"id":"6ptw79a","elType":"column","settings":{"_column_size":33,"_inline_size":null,"background_background":"none","animation":"fadeIn"},"elements":[{"id":"kpadzz8","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/teammate1.jpg","id":279},"align":"left","align_tablet":"left","align_mobile":"left"},"elements":[],"widgetType":"image"},{"id":"knxp4c3","elType":"widget","settings":{"title":"FRED BUSTER","header_size":"h4","title_color":"#000000","typography_typography":"custom","typography_text_transform":"uppercase","typography_font_weight":"900"},"elements":[],"widgetType":"heading"},{"id":"7syjklq","elType":"widget","settings":{"editor":"<p>MANAGER<\/p>","typography_typography":"custom","typography_font_weight":"400","_margin":{"unit":"px","top":"-15","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"text-editor"},{"id":"pd1lu1i","elType":"widget","settings":{"social_icon_list":[{"social":"fa fa-facebook","_id":"z6ub5rs","link":{"is_external":"true","url":""}},{"social":"fa fa-twitter","_id":"iq06iau","link":{"is_external":"true","url":""}},{"social":"fa fa-google-plus","_id":"b0a3i9i","link":{"is_external":"true","url":""}}],"align":"left","icon_color":"custom","icon_primary_color":"#545454","icon_size":{"unit":"px","size":"12"}},"elements":[],"widgetType":"social-icons"}],"isInner":true},{"id":"gnarny5","elType":"column","settings":{"_column_size":33,"_inline_size":null,"animation":"fadeIn"},"elements":[{"id":"hgql66n","elType":"widget","settings":{"image":{"url":"http:\/\/sites-wpastra.sharkz.in\/astra-lite-demo-1\/wp-content\/uploads\/sites\/30\/2017\/06\/teammate2.jpg","id":308},"align":"left","align_tablet":"left","align_mobile":"left"},"elements":[],"widgetType":"image"},{"id":"b2v7zae","elType":"widget","settings":{"title":"LISA HOFFMAN","header_size":"h4","title_color":"#000000","typography_typography":"custom","typography_text_transform":"uppercase","typography_font_weight":"900"},"elements":[],"widgetType":"heading"},{"id":"t9tw7ru","elType":"widget","settings":{"editor":"<p>MANAGER<\/p>","typography_typography":"custom","typography_font_weight":"400","_margin":{"unit":"px","top":"-15","right":"0","bottom":"0","left":"0","isLinked":false}},"elements":[],"widgetType":"text-editor"},{"id":"twocv5r","elType":"widget","settings":{"social_icon_list":[{"social":"fa fa-facebook","_id":"z6ub5rs","link":{"is_external":"true","url":""}},{"social":"fa fa-twitter","_id":"iq06iau","link":{"is_external":"true","url":""}},{"social":"fa fa-google-plus","_id":"b0a3i9i","link":{"is_external":"true","url":""}}],"align":"left","icon_color":"custom","icon_primary_color":"#545454","icon_size":{"unit":"px","size":"12"}},"elements":[],"widgetType":"social-icons"}],"isInner":true}],"isInner":true},{"id":"jekhke6","elType":"widget","settings":{"space":{"unit":"px","size":"100"},"space_tablet":{"unit":"px","size":"30"},"space_mobile":{"unit":"px","size":"5"}},"elements":[],"widgetType":"spacer"}],"isInner":false}],"isInner":false},{"id":"l3u9k3z","elType":"section","settings":{"stretch_section":"section-stretched","content_position":"middle","structure":"20","background_background":"classic","background_color":"#4064d7","background_position":"bottom center","background_attachment":"fixed","background_size":"cover","background_overlay_background":"classic","background_overlay_color":"rgba(0,0,0,0.4)","padding":{"unit":"px","top":"25","right":"0","bottom":"25","left":"0","isLinked":false},"padding_tablet":{"unit":"px","top":"20","right":"20","bottom":"20","left":"10","isLinked":false},"padding_mobile":{"unit":"px","top":"50","right":"10","bottom":"50","left":"10","isLinked":false}},"elements":[{"id":"d5pqnov","elType":"column","settings":{"_column_size":50,"_inline_size":"65.000"},"elements":[{"id":"va2oy3s","elType":"widget","settings":{"title":"Would you like to start a project with us?","header_size":"h3","align_mobile":"center","title_color":"#ffffff","typography_typography":"custom","typography_font_size_tablet":{"unit":"px","size":"18"},"_margin_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"_padding_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"typography_font_size":{"unit":"px","size":"28"},"typography_font_weight":"500","typography_line_height":{"unit":"px","size":""}},"elements":[],"widgetType":"heading"},{"id":"dli9apk","elType":"widget","settings":{"title":"Etiam erat lectus, finibus eget commodo quis, tincidunt eget leo. Nullam quis vulputate orci, ac accumsan quam. Morbi fringilla congue libero.","header_size":"p","align_mobile":"center","title_color":"#ffffff","typography_typography":"custom","typography_font_size_tablet":{"unit":"px","size":"14"},"_margin_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"_padding_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true},"typography_font_size":{"unit":"px","size":"15"},"typography_font_weight":"200","typography_line_height":{"unit":"px","size":"26"}},"elements":[],"widgetType":"heading"}],"isInner":false},{"id":"tx182f6","elType":"column","settings":{"_column_size":50,"_inline_size":"35.000","padding_tablet":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true}},"elements":[{"id":"sf4whbd","elType":"widget","settings":{"text":"1-800-1234-567","typography_typography":"custom","typography_font_size":{"unit":"em","size":"0.9"},"typography_font_family":"Montserrat","typography_font_weight":"700","typography_text_transform":"uppercase","typography_letter_spacing":{"unit":"px","size":"3"},"border_radius":{"unit":"px","top":"50","right":"50","bottom":"50","left":"50","isLinked":true},"button_type":"info","align":"right","button_text_color":"#ffffff","background_color":"rgba(64,100,215,0)","hover_color":"#4064d7","button_background_hover_color":"#ffffff","border_width":{"unit":"px","top":"2","right":"2","bottom":"2","left":"2","isLinked":true},"border_color":"#ffffff","align_tablet":"right","button_hover_border_color":"#ffffff","text_padding":{"unit":"px","top":"15","right":"30","bottom":"15","left":"30","isLinked":false},"align_mobile":"center","_padding_mobile":{"unit":"px","top":"0","right":"30","bottom":"0","left":"30","isLinked":false},"border_border":"solid","_margin":{"unit":"px","top":"0","right":"0","bottom":"0","left":"0","isLinked":true}},"elements":[],"widgetType":"button"}],"isInner":false}],"isInner":false}]';
			// update_post_meta( get_the_id(), '_elementor_data', $data );

	// $data = json_decode( $data );			
	// 		$images = array_column($data, 'background_image');
			// vl( $images );
			vl( json_decode( $data ) );
			wp_die();
		}

		function set_image_import_on() {
			update_option( '_astra_sites_elementor_image_import', true );
		}

		function set_image_import_off() {
			update_option( '_astra_sites_elementor_image_import', false );
		}

		/**
		 * Process handler
		 */
		public function astra_sites_process_handler() {
			// vl( get_the_ID() );

			// if( get_the_ID() === 21 ) {
			// 	vl( get_the_ID() );
			// 	vl( 'importing...' );
			// 	$this->process_all->push_to_queue( get_the_ID() );
			// 	$this->process_all->save()->dispatch();
			// }
			// wp_die();

			if( get_option( '_astra_sites_elementor_image_import' ) ) {
				error_log( '_astra_sites_elementor_image_import : TRUE' );
			} else {
				error_log( '_astra_sites_elementor_image_import : FALSE' );
			}

			// $import = get_option( '_astra_sites_elementor_image_import', false );
			// if( $import ) {
				$this->handle_all();
			// }
			// 	vl( 'importing...' );
			// 	vl( $imported );
			// 	wp_die();
			// }
			// $imported++;
			// update_site_option( '_astra_sites_elementor_image_import', $imported );
		}

		/**
		 * Handle all
		 */
		protected function handle_all() {
			$names = $this->get_pages();

			if( is_array( $names ) ) {
				foreach ( $names as $name ) {
					error_log( $name );
					$this->process_all->push_to_queue( $name );
				}
				$this->process_all->save()->dispatch();
			}
		}

		/**
		 * Get names
		 *
		 * @return array
		 */
		protected function get_pages() {

			$args = array(
				'post_type'    => 'page',

				// Query performance optimization.
				'fields'        => 'ids',
				'no_found_rows' => true,
				'post_status'   => 'publish',
			);

			$query = new WP_Query( $args );

			// Have posts?
			if ( $query->have_posts() ) :

				return $query->posts;
				// while ( $query->have_posts() ) {

				// 	$query->the_post();

				// 	vl( get_the_id() );
				// }

				// // Restore original post data.
				// wp_reset_postdata();

			endif;

			return;
		}

	}

	/**
	 * Kicking this off by calling 'set_instance()' method
	 */
	Astra_Sites_Comp_Elementor::set_instance();

endif;
